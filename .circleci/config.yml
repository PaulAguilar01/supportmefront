aliases:
  - &filter-only-master
    branches:
      only:
        - 3-include-pipeline

attach-workspace: &attach-workspace
  attach_workspace:
    at: ~/repo

version: 2.1
jobs:
  build:
    working_directory: ~/repo
    docker:
      - image: circleci/node:4.8.2 # the primary container, where your job's commands are run
    steps:
      - checkout # check out the code in the project directory
      - run: echo "hello world" # run the `echo` command
  test:
    working_directory: ~/repo
    docker:
      - image: circleci/node:4.8.2 # the primary container, where your job's commands are run
    steps:
      - checkout # check out the code in the project directory
      - run: npm test

  workflows:
    version: 2
    build-and-test:
      jobs:
        - build
        - test:
          requires:
            - build
          filters: *filter-only-master
